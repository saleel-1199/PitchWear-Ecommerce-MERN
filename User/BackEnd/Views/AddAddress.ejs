<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Add Address | PitchWear</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white">

<header class="bg-[#F6F6D8] px-10 py-4 flex items-center justify-between">
  <h1 class="font-bold text-lg">PitchWear</h1>
  <nav class="flex gap-8 text-sm">
    <a href="/home">Home</a>
    <a href="/shop">Shop</a>
    <a href="/about">About</a>
    <a href="/contact">Contact</a>
  </nav>
  <div class="flex gap-4"><span>üîç</span><span>üõí</span><span>üë§</span></div>
</header>

<div class="max-w-6xl mx-auto px-10 py-10 flex gap-10">

  <!-- Sidebar -->
  <aside class="w-64">
    <p class="text-sm text-gray-500">My Account</p>
    <p class="font-semibold"><%= user.full_name || "User" %></p>

    <ul class="mt-6 space-y-3 text-sm">
      <li><a href="/orders">My Orders</a></li>
      <li class="font-semibold bg-gray-100 p-2 rounded">Address Book</li>
      <li><a href="/wallet">Wallet</a></li>
    </ul>
  </aside>

  <!-- Form -->
  <main class="flex-1">
    <h2 class="text-3xl font-bold mb-10 text-center">Add new address</h2>

    <form id="addressForm" action="/address" method="POST" class="max-w-xl mx-auto space-y-6">

      <div>
        <label class="text-sm font-medium">Full name</label>
        <input
          name="full_name"
          class="w-full border rounded-md px-4 py-2 mt-1"
          placeholder="Enter your full name"
          required
        />
      </div>

      <div class="grid grid-cols-2 gap-6">
        <div>
          <label class="text-sm font-medium">Phone number</label>
          <input
            id="phone_no"
            name="phone_no"
            type="text"
            inputmode="numeric"
            minlength="10"
            maxlength="10"
            pattern="^[0-9]{10}$"
            title="Phone number must be exactly 10 digits"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter 10 digit phone number"
            required
          />
          <p id="phoneError" class="text-xs text-red-500 mt-1 hidden">
            Phone number must be exactly 10 digits.
          </p>
        </div>

        <div>
          <label class="text-sm font-medium">Alternative Phone (optional)</label>
          <input
            id="alt_phone_no"
            name="alt_phone_no"
            type="text"
            inputmode="numeric"
            minlength="10"
            maxlength="10"
            pattern="^$|^[0-9]{10}$"
            title="Alternative phone must be exactly 10 digits"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter 10 digit phone (optional)"
          />
          <p id="altPhoneError" class="text-xs text-red-500 mt-1 hidden">
            Alternative phone must be exactly 10 digits.
          </p>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-6">
        <div>
          <label class="text-sm font-medium">Address line</label>
          <input
            name="address_line1"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter your address line"
            required
          />
        </div>
        <div>
          <label class="text-sm font-medium">City</label>
          <input
            name="city"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter your city"
            required
          />
        </div>
      </div>

      <div class="grid grid-cols-2 gap-6">
        <div>
          <label class="text-sm font-medium">PIN Code</label>
          <input
            id="pin_code"
            name="pin_code"
            type="text"
            inputmode="numeric"
            minlength="6"
            maxlength="6"
            pattern="^[0-9]{6}$"
            title="Pincode must be exactly 6 digits"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter 6 digit pincode"
            required
          />
          <p id="pinError" class="text-xs text-red-500 mt-1 hidden">
            Pincode must be exactly 6 digits.
          </p>
        </div>

        <div>
          <label class="text-sm font-medium">State</label>
          <input
            name="state"
            class="w-full border rounded-md px-4 py-2 mt-1"
            placeholder="Enter your state"
            required
          />
        </div>
      </div>

      <div>
        <label class="text-sm font-medium">Address type</label>
        <select name="type" class="w-full border rounded-md px-4 py-2 mt-1" required>
          <option value="">Select address type</option>
          <option value="Home">Home</option>
          <option value="Work">Work</option>
        </select>
      </div>

      <div class="flex items-center justify-between">
        <label class="text-sm font-medium">Default Address</label>
        <input type="checkbox" name="is_default" class="w-5 h-5" />
      </div>

      <div class="flex justify-center gap-4 pt-4">
        <button class="bg-green-600 text-white px-6 py-2 rounded-md">Save Address</button>
        <a href="/address" class="bg-gray-200 px-6 py-2 rounded-md">Cancel</a>
      </div>

    </form>
  </main>

</div>

<!-- ‚úÖ JS validation + digit only restriction -->
<script>
  const phoneInput = document.getElementById("phone_no");
  const altPhoneInput = document.getElementById("alt_phone_no");
  const pinInput = document.getElementById("pin_code");

  const phoneError = document.getElementById("phoneError");
  const altPhoneError = document.getElementById("altPhoneError");
  const pinError = document.getElementById("pinError");

  function onlyDigitsAndLimit(input, maxLen) {
    input.addEventListener("input", () => {
      input.value = input.value.replace(/\D/g, "").slice(0, maxLen);
    });
  }

  onlyDigitsAndLimit(phoneInput, 10);
  onlyDigitsAndLimit(altPhoneInput, 10);
  onlyDigitsAndLimit(pinInput, 6);

  document.getElementById("addressForm").addEventListener("submit", (e) => {
    const phoneOk = /^\d{10}$/.test(phoneInput.value.trim());
    const pinOk = /^\d{6}$/.test(pinInput.value.trim());

    const altVal = altPhoneInput.value.trim();
    const altOk = altVal === "" || /^\d{10}$/.test(altVal);

    phoneError.classList.toggle("hidden", phoneOk);
    pinError.classList.toggle("hidden", pinOk);
    altPhoneError.classList.toggle("hidden", altOk);

    if (!phoneOk || !pinOk || !altOk) {
      e.preventDefault();
    }
  });
</script>

</body>
</html>
